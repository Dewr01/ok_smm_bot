# OK SMM Combiner

SMM-–∫–æ–º–±–∞–π–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–π –≤ –û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∞—Ö. –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–π, –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ Telegram-–±–æ—Ç–∞.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –í–µ–±‚Äë–∞–¥–º–∏–Ω–∫–∞ (Flask + SQLite) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–∞–º–∏ –∏ –ø–æ—Å—Ç–∞–º–∏.
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π (AI‚Äë–≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –ø—É–ª –∫–æ–Ω—Ç–µ–Ω—Ç–∞, —Ç—Ä–µ–Ω–¥—ã, –∞–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥).
- Telegram‚Äë–±–æ—Ç‚Äë–∞–¥–º–∏–Ω: –ø—Ä–æ—Å–º–æ—Ç—Ä –æ—á–µ—Ä–µ–¥–∏, –ø—É–±–ª–∏–∫–∞—Ü–∏—è –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ –∏–∑ —á–∞—Ç–∞.
- –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø–æ—Å—Ç–æ–≤ (auto_scheduler).
- REST‚ÄëAPI –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π.
- –ü—Ä–æ—Å—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `.env`.

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
git clone https://github.com/Dewr01/ok_smm_bot.git
cd ok_smm_bot
```

### 2. –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```bash
python -m venv .venv
source .venv/bin/activate   # Linux/macOS
.venv\Scripts\activate    # Windows
```

### 3. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install -r requirements.txt
```

### 4. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example` –∏ —É–∫–∞–∂–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è:
```
# OK API –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
OK_APP_KEY=your_ok_app_key
OK_ACCESS_TOKEN=your_ok_access_token
OK_SESSION_SECRET_KEY=your_ok_session_secret
OK_GROUP_ID=your_group_id

# Telegram –±–æ—Ç
TG_BOT_TOKEN=your_telegram_bot_token

# AI —Å–µ—Ä–≤–∏—Å—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
OPENAI_API_KEY=sk-...  # –¥–ª—è AI –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
GIGACHAT_AUTH_KEY=your_gigachat_key  # –¥–ª—è AI —Ç–µ–∫—Å—Ç–æ–≤

# RSS —Ñ–∏–¥—ã –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
RSS_FEEDS=https://habr.com/ru/rss/flows/develop/all/,
https://anekdot.ru/rss/export_j.xml,
...

# –ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏
PARTNER_LINK=https://partner.example/consult

# SMTP –¥–ª—è —Ä–∞—Å—Å—ã–ª–æ–∫
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password
SMTP_FROM=your_email@gmail.com

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
FLASK_PORT=5010
FLASK_SECRET_KEY=your_secret_key
ADMIN_USERNAME=admin
ADMIN_PASSWORD=changeme
```

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

### Flask‚Äë–∞–¥–º–∏–Ω–∫–∞
```bash
python app.py
```
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ `http://127.0.0.1:5010`  
–ê–¥–º–∏–Ω–∫–∞: `http://127.0.0.1:5010/admin` (Basic‚ÄëAuth –∏–∑ `.env`).

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–≤ –¥—Ä—É–≥–æ–º –æ–∫–Ω–µ)

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –ë–î –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ RSS_FEEDS
python seed.py
```
```bash
# AI –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ë–î –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
python seed_ai.py
```


### Telegram‚Äë–±–æ—Ç
–ï—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω –º–æ–¥—É–ª—å `tg_admin` –∏ –∑–∞–¥–∞–Ω `TG_BOT_TOKEN`, –±–æ—Ç —Å—Ç–∞—Ä—Ç—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–º–µ—Å—Ç–µ —Å Flask.  
–ö–æ–º–∞–Ω–¥—ã:
- `/start` ‚Äî —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥.
- `/update_posts` - –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤. (–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å—Ä–∞–∑—É seed.py –∏ seed_ai.py)
- `/queue` ‚Äî –æ—á–µ—Ä–µ–¥—å –ø—É–±–ª–∏–∫–∞—Ü–∏–π.
- `/publish <–Ω–æ–º–µ—Ä>` ‚Äî –ø—É–±–ª–∏–∫–∞—Ü–∏—è –ø–æ—Å—Ç–∞.
- `/addpost <—Ç–µ–∫—Å—Ç>` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø–æ—Å—Ç –≤ –æ—á–µ—Ä–µ–¥—å.
- `/preview <id>` - –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å—Ç–∞.
- `/delete <id>` - —É–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç.
- `/addpost <—Ç–µ–∫—Å—Ç>` - –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø–æ—Å—Ç.

> ‚ö†Ô∏è –í —Ä–µ–∂–∏–º–µ `debug=True` Flask –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å. –ß—Ç–æ–±—ã –±–æ—Ç –Ω–µ —Å—Ç–∞—Ä—Ç–æ–≤–∞–ª –¥–≤–∞–∂–¥—ã, –≤ `app.py` —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `WERKZEUG_RUN_MAIN`.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
ok_bot/
‚îú‚îÄ‚îÄ admin/                 # –í–µ–±-–∞–¥–º–∏–Ω–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ templates/        # HTML —à–∞–±–ª–æ–Ω—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ routes.py         # –†–æ—É—Ç—ã –∞–¥–º–∏–Ω–∫–∏
‚îú‚îÄ‚îÄ modules/              # –ú–æ–¥—É–ª–∏ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ autopost.py       # –ê–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥
‚îÇ   ‚îú‚îÄ‚îÄ ai_writer.py      # AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ ai_images.py      # AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ tg_admin.py       # Telegram –±–æ—Ç
‚îÇ   ‚îî‚îÄ‚îÄ ...              # –î—Ä—É–≥–∏–µ –º–æ–¥—É–ª–∏
‚îú‚îÄ‚îÄ static/              # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ assistant.db         # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îú‚îÄ‚îÄ app.py              # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ db.py               # –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ config.py           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ seed.py            # –ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
‚îú‚îÄ‚îÄ seed_ai.py            # –ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
‚îî‚îÄ‚îÄ requirements.txt    # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```
## üõ† –ú–æ–¥—É–ª–∏ —Å–∏—Å—Ç–µ–º—ã

### –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π

#### ‚úÖ **–í–∫–ª—é—á–µ–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
* autopost - –∞–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥
* analytics - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
* partner - –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏
* content_pool - —Å–±–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–∑ RSS
* tg_admin - Telegram –±ot

#### ‚öôÔ∏è **–¢—Ä–µ–±—É—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
* ai_writer - –Ω—É–∂–µ–Ω GIGACHAT_AUTH_KEY
* ai_images - –Ω—É–∂–µ–Ω OPENAI_API_KEY
* newsletter - –Ω—É–∂–Ω—ã SMTP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## üìä –†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤

#### –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
* –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ /admin/posts
* –î–æ–±–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç, –∫–∞—Ä—Ç–∏–Ω–∫—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ), –≤—ã–±–µ—Ä–∏—Ç–µ —à–∞–±–ª–æ–Ω

#### –ß–µ—Ä–µ–∑ Telegram:
```text
/addpost –í–∞—à —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞
```

#### –ß–µ—Ä–µ–∑ –∏–º–ø–æ—Ä—Ç CSV:
* –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∏–º–ø–æ—Ä—Ç –∏–∑ CSV —Ñ–∞–π–ª–∞
* –§–æ—Ä–º–∞—Ç: text,template,date(YYYY-MM-DD),time(HH:MM)

### 2. –®–∞–±–ª–æ–Ω—ã –ø–æ—Å—Ç–æ–≤

–°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã:

* –°–æ–≤–µ—Ç –¥–Ω—è - —Å–æ–≤–µ—Ç—ã –ø–æ –∑–¥–æ—Ä–æ–≤–æ–º—É –æ–±—Ä–∞–∑—É –∂–∏–∑–Ω–∏
* –¢–û–ü-5 - —Å–ø–∏—Å–∫–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
* –í–æ–ø—Ä–æ—Å –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º - –≤–æ–≤–ª–µ–∫–∞—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

### 3. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–π

* –ê–≤—Ç–æ–∫–∞–ª–µ–Ω–¥–∞—Ä—å - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ –Ω–∞ –Ω–µ–¥–µ–ª—é
* –†—É—á–Ω–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ - drag&drop –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
* Best time - –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤ –ª—É—á—à–µ–µ –≤—Ä–µ–º—è based on analytics

## üîß API endpoints

* POST /webhook - –≤–µ–±—Ö—É–∫–∏ –æ—Ç –û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–æ–≤
* GET /r/<slug> - –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã
* POST /admin/publish_now/<id> - –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è
* GET /admin/analytics - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

## üê≥ Docker –∑–∞–ø—É—Å–∫

–ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤–µ–±‚Äë–∞–¥–º–∏–Ω–∫—É –∏ Telegram‚Äë–±–æ—Ç–∞ –∫–∞–∫ –¥–≤–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞.

**docker-compose.yml** (–ø—Ä–∏–º–µ—Ä):

```yaml
version: "3.9"
services:
  web:
    build: .
    command: python app.py
    volumes:
      - .:/app
    env_file:
      - .env
    ports:
      - "5010:5010"

  tg_bot:
    build: .
    command: python -m modules.tg_admin
    volumes:
      - .:/app
    env_file:
      - .env
```

–ó–∞–ø—É—Å–∫:
```bash
docker-compose up --build
```

–¢–µ–ø–µ—Ä—å:
- –ê–¥–º–∏–Ω–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ `http://127.0.0.1:5010`  
- Telegram‚Äë–±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ –∏ –Ω–µ –º–µ—à–∞–µ—Ç Flask.


## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

- –ö–æ–¥ —Ä–∞–∑–±–∏—Ç –Ω–∞ –º–æ–¥—É–ª–∏ –≤ –ø–∞–ø–∫–µ `modules/`.
- –î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –º–æ–¥—É–ª—è —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `modules/<–∏–º—è>.py` –∏ —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –∫–ª–∞—Å—Å, –Ω–∞—Å–ª–µ–¥—É—é—â–∏–π `ModuleBase`.
- –í–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`MODULE_<NAME>=true`).

## üìå –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è
- Alembic –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
- –ü–µ—Ä–µ—Ö–æ–¥ —Å Basic‚ÄëAuth –Ω–∞ Flask‚ÄëLogin —Å —Å–µ—Å—Å–∏—è–º–∏ –∏ CSRF‚Äë–∑–∞—â–∏—Ç–æ–π.
- CI (GitHub Actions) –¥–ª—è –ª–∏–Ω—Ç–∏–Ω–≥–∞ –∏ —Ç–µ—Å—Ç–æ–≤.

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è
MIT
