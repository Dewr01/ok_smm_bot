{% extends "base.html" %}
{% block content %}
<h2>Контент</h2>
<form method="post">
  <label>Текст<br><textarea name="text" placeholder="Текст..."></textarea></label>
  <label>Картинка (путь)<br><input name="image" placeholder="static/images/your.png"></label>
  <label>Шаблон<br>
    <select name="template">
      <option value="">—</option>
      {% for t in templates %}
        <option value="{{ t.name }}">{{ t.name }}</option>
      {% endfor %}
    </select>
  </label>
  <button type="submit">Добавить</button>
</form>

<h3>Импорт CSV</h3>
<form method="post" action="/admin/import_csv" enctype="multipart/form-data">
  <input type="file" name="file" accept=".csv">
  <button type="submit">Импортировать</button>
  <p>Формат: text,template,date(YYYY-MM-DD),time(HH:MM)</p>
</form>

<h3>A/B тест</h3>
<form method="post" action="/admin/ab/create">
  <label>Название <input name="name" placeholder="Новый A/B"></label>
  <label>Вариант A<br><textarea name="a_text"></textarea></label>
  <label>Вариант B<br><textarea name="b_text"></textarea></label>
  <button type="submit">Создать</button>
</form>

<table>
  <thead><tr><th>ID</th><th>Текст</th><th>Шаблон</th><th>Статус</th><th>План</th><th>Действия</th></tr></thead>
  <tbody>
  {% for p in posts %}
  <tr>
    <td>{{ p.id }}</td>
    <td style="max-width:520px; white-space:pre-line">{{ p.text }}</td>
    <td>{{ p.template }}</td>
    <td><span class="badge">{{ p.status }}</span></td>
    <td>
      <form method="post" action="/admin/schedule">
        <input type="hidden" name="post_id" value="{{ p.id }}">
        <input type="date" name="date" required>
        <input type="time" name="time" required>
        <button type="submit">Поставить</button>
      </form>
    </td>
    <td>
      <form method="post" action="/admin/publish_now/{{ p.id }}">
        <button type="submit">Опубликовать</button>
      </form>
    </td>
  </tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
